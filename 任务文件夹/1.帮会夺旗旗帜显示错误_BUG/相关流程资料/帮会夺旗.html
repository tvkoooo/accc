<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>帮会夺旗</title>
</head>
<body>
<div id="wmd-preview" class="wmd-preview"><div class="md-section-divider"></div><div class="md-section-divider"></div><h2 data-anchor-id="a8g0" id="帮会夺旗">帮会夺旗</h2><div class="md-section-divider"></div><h3 data-anchor-id="akf3" id="暂时不做的功能">暂时不做的功能</h3><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="cb0q"><ol class="linenums"><li class="L0"><code><span class="pun">凡是涉及到奖励的部分和帮会任务的部分都暂时不做</span></code></li><li class="L1"><code><span class="lit">1.</span><span class="pun">夺旗成功后在直播间内阳光掉落加成</span><span class="lit">50</span><span class="pun">%.(延后)</span></code></li><li class="L2"><code><span class="lit">2.</span><span class="pun">参与夺旗成员一分钟帮会贡献和每日帮会贡献</span><span class="lit">100.</span><span class="pun">(延后)</span></code></li><li class="L3"><code><span class="lit">3.</span><span class="pun">帮会集结令和帮会任务.(延后)</span></code></li><li class="L4"><code><span class="lit">4.</span><span class="pun">帮会星级和星级任务.(延后)</span></code></li><li class="L5"><code><span class="lit">5.</span><span class="pun">帮会任务宝箱掉落详情.(延后)</span></code></li></ol></pre><div class="md-section-divider"></div><h3 data-anchor-id="0q87" id="基本数据集">基本数据集</h3><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="49ox"><ol class="linenums"><li class="L0"><code><span class="pun">房间[空旗,夺旗,抢旗]</span><span class="pln"> </span><span class="pun">状态</span></code></li><li class="L1"><code><span class="pun">房间当前插旗帮会</span><span class="pln">     </span><span class="pun">基础数据</span></code></li></ol></pre><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="ndq0"><ol class="linenums"><li class="L0"><code><span class="pun">帮会编号(拓展)</span></code></li><li class="L1"><code><span class="pun">帮会名称</span></code></li><li class="L2"><code><span class="pun">帮会图标</span></code></li><li class="L3"><code><span class="pun">旗子标识(通用图片资源)</span></code></li><li class="L4"><code><span class="pun">夺旗人数</span></code></li></ol></pre><p data-anchor-id="nuz5">帮会夺旗主体状态</p><table data-anchor-id="jnxu" class="table table-striped-white table-bordered">
<thead>
<tr>
 <th style="text-align:left;">空旗</th>
 <th style="text-align:left;">已开启夺旗</th>
 <th style="text-align:left;">被某帮会插旗</th>
</tr>
</thead>
<tbody><tr>
 <td style="text-align:left;">-1</td>
 <td style="text-align:left;">0</td>
 <td style="text-align:left;">帮会编号</td>
</tr>
</tbody></table><p data-anchor-id="w4k8">空旗状态中,有帮会的任何人可以通过开启插旗的动作(点击旗位按钮或更多"..."弹出夺旗按钮,进行夺旗)开启抢旗。</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="suj5"><ol class="linenums"><li class="L0"><code><span class="com">// 夺旗详情数据</span></code></li><li class="L1"><code><span class="com">// faction_id 夺旗状态(-1无 0 开启 &gt;0 帮会id)</span></code></li><li class="L2"><code><span class="pln">message flag_faction_info</span></code></li><li class="L3"><code><span class="pun">{</span></code></li><li class="L4"><code><span class="pln">    required uint32 faction_id                </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 帮派id</span></code></li><li class="L5"><code><span class="pln">    required </span><span class="kwd">string</span><span class="pln"> faction_name              </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">""</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 帮派名称</span></code></li><li class="L6"><code><span class="pln">    required </span><span class="kwd">string</span><span class="pln"> faction_icon              </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">""</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 帮派图标</span></code></li><li class="L7"><code><span class="pln">    required uint32 flag_number               </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 夺旗人数</span></code></li><li class="L8"><code><span class="pln">    required uint32 faction_level             </span><span class="pun">=</span><span class="pln"> </span><span class="lit">5</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 帮派等级</span></code></li><li class="L9"><code><span class="pun">}</span></code></li></ol></pre><div class="md-section-divider"></div><h3 data-anchor-id="wggs" id="缓存数据集">缓存数据集</h3><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="tbsa"><ol class="linenums"><li class="L0"><code><span class="com">//faction_base_info</span></code></li><li class="L1"><code><span class="pln">message flag_faction_cache_info</span></code></li><li class="L2"><code><span class="pun">{</span></code></li><li class="L3"><code><span class="pln">    required </span><span class="kwd">string</span><span class="pln"> faction_id                </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">""</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 帮派id</span></code></li><li class="L4"><code><span class="pln">    required </span><span class="kwd">string</span><span class="pln"> faction_name              </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">""</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 帮派名称</span></code></li><li class="L5"><code><span class="pln">    required </span><span class="kwd">string</span><span class="pln"> faction_icon              </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">""</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 帮派图标</span></code></li><li class="L6"><code><span class="pln">    required </span><span class="kwd">string</span><span class="pln"> faction_level             </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">""</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 帮派等级</span></code></li><li class="L7"><code><span class="pln">    required </span><span class="kwd">string</span><span class="pln"> faction_time              </span><span class="pun">=</span><span class="pln"> </span><span class="lit">5</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">""</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 缓存获取时间</span></code></li><li class="L8"><code><span class="pun">}</span></code></li><li class="L9"><code><span class="pln">message flag_faction_current_info</span></code></li><li class="L0"><code><span class="pun">{</span></code></li><li class="L1"><code><span class="pln">    required uint32 faction_id                </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">""</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 帮派id</span></code></li><li class="L2"><code><span class="pln">    required uint32 timecode                  </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">""</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 夺旗事件点</span></code></li><li class="L3"><code><span class="pun">}</span></code></li></ol></pre><p data-anchor-id="mnxi">帮会夺旗普通旗帜资源缓存数据</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="tkfx"><ol class="linenums"><li class="L0"><code><span class="pun">帮会夺旗基础缓存数据,在开启夺旗时做一次更新</span></code></li><li class="L1"><code><span class="pun">(</span><span class="pln">redis</span><span class="pun">)</span><span class="kwd">string</span><span class="pln"> faction</span><span class="pun">:</span><span class="pln">flag</span><span class="pun">:</span><span class="pln">flag_icon</span></code></li><li class="L2"><code><span class="pun">{</span></code></li><li class="L3"><code><span class="pln">    </span><span class="pun">(</span><span class="kwd">string</span><span class="pln"> flag_icon</span><span class="pun">),</span></code></li><li class="L4"><code><span class="pun">}</span></code></li><li class="L5"><code><span class="pun">(</span><span class="pln">cache</span><span class="pun">)</span><span class="pln">EXPIRE </span><span class="lit">10</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">60</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">600</span><span class="pun">(</span><span class="pln">s</span><span class="pun">)</span></code></li></ol></pre><p data-anchor-id="3flb">帮会夺旗基础缓存数据</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="whou"><ol class="linenums"><li class="L0"><code><span class="pun">帮会夺旗基础缓存数据,替换夺旗帮派时做一次更新</span></code></li><li class="L1"><code><span class="pun">(</span><span class="pln">redis</span><span class="pun">)</span><span class="pln">hash faction</span><span class="pun">:</span><span class="pln">flag</span><span class="pun">:</span><span class="pln">base_info</span><span class="pun">:%</span><span class="pln">u</span><span class="pun">(</span><span class="pln">uint32 faction_id </span><span class="pun">%</span><span class="pln"> </span><span class="lit">1024</span><span class="pun">)</span><span class="pln"> </span></code></li><li class="L2"><code><span class="pun">{</span></code></li><li class="L3"><code><span class="pln">    k</span><span class="pun">(</span><span class="pln">uint32 faction_id</span><span class="pun">),</span></code></li><li class="L4"><code><span class="pln">    v</span><span class="pun">(</span><span class="kwd">string</span><span class="pln"> json</span><span class="pun">(</span><span class="pln">flag_faction_cache_info</span><span class="pun">)),</span></code></li><li class="L5"><code><span class="pun">}</span></code></li><li class="L6"><code><span class="pun">(</span><span class="pln">cache</span><span class="pun">)</span><span class="pln">EXPIRE </span><span class="pun">-</span><span class="lit">1</span></code></li></ol></pre><p data-anchor-id="23cz">帮会插旗人数数据</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="7wuq"><ol class="linenums"><li class="L0"><code><span class="pun">(</span><span class="pln">redis</span><span class="pun">)</span><span class="pln">zset faction</span><span class="pun">:</span><span class="pln">flag</span><span class="pun">:</span><span class="pln">number_info</span><span class="pun">:%</span><span class="pln">u</span><span class="pun">(</span><span class="pln">sid</span><span class="pun">房间号)</span></code></li><li class="L1"><code><span class="pun">{</span></code></li><li class="L2"><code><span class="pln">    k</span><span class="pun">(</span><span class="pln">uint32 faction_id</span><span class="pun">),</span></code></li><li class="L3"><code><span class="pln">    score</span><span class="pun">(</span><span class="pln">uint32 number</span><span class="pun">),</span></code></li><li class="L4"><code><span class="pun">}</span><span class="pln"> </span></code></li><li class="L5"><code><span class="pun">(</span><span class="pln">cache</span><span class="pun">)</span><span class="pln">EXPIRE </span><span class="lit">3</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">24</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">60</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">60</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">259200</span><span class="pun">(</span><span class="pln">s</span><span class="pun">)</span></code></li></ol></pre><p data-anchor-id="6n8h">帮会插旗成员数据</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="ipt6"><ol class="linenums"><li class="L0"><code><span class="pun">(</span><span class="pln">redis</span><span class="pun">)</span><span class="pln">zset faction</span><span class="pun">:</span><span class="pln">flag</span><span class="pun">:</span><span class="pln">member_info</span><span class="pun">:%</span><span class="pln">u</span><span class="pun">(</span><span class="pln">sid</span><span class="pun">房间号):%</span><span class="pln">u</span><span class="pun">(</span><span class="pln">uint32 faction_id</span><span class="pun">帮派号)</span></code></li><li class="L1"><code><span class="pun">{</span></code></li><li class="L2"><code><span class="pln">    k</span><span class="pun">(</span><span class="pln">uint64 uid</span><span class="pun">),</span></code></li><li class="L3"><code><span class="pln">    score</span><span class="pun">(</span><span class="pln">uint32 timecode</span><span class="pun">),</span></code></li><li class="L4"><code><span class="pun">}</span><span class="pln"> </span></code></li><li class="L5"><code><span class="pun">(</span><span class="pln">cache</span><span class="pun">)</span><span class="pln">EXPIRE </span><span class="lit">3</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">24</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">60</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">60</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">259200</span><span class="pun">(</span><span class="pln">s</span><span class="pun">)</span></code></li></ol></pre><p data-anchor-id="dq2h">帮会插旗当前占旗数据</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="h0sp"><ol class="linenums"><li class="L0"><code><span class="pun">(</span><span class="pln">redis</span><span class="pun">)</span><span class="pln">hash faction</span><span class="pun">:</span><span class="pln">flag</span><span class="pun">:</span><span class="pln">current_info</span><span class="pun">:%</span><span class="pln">u</span><span class="pun">(</span><span class="pln">sid</span><span class="pun">房间号</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="lit">1024</span><span class="pun">)</span><span class="pln"> </span></code></li><li class="L1"><code><span class="pun">{</span></code></li><li class="L2"><code><span class="pln">    k</span><span class="pun">(</span><span class="pln">uint64 sid</span><span class="pun">房间号),</span></code></li><li class="L3"><code><span class="pln">    v</span><span class="pun">(</span><span class="kwd">string</span><span class="pln"> json</span><span class="pun">(</span><span class="pln">flag_faction_current_info</span><span class="pun">)),</span></code></li><li class="L4"><code><span class="pun">}</span></code></li><li class="L5"><code><span class="pun">(</span><span class="pln">cache</span><span class="pun">)</span><span class="pln">EXPIRE </span><span class="pun">-</span><span class="lit">1</span></code></li></ol></pre><p data-anchor-id="9k3n">帮会插旗夺旗动作时间数据</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="676y"><ol class="linenums"><li class="L0"><code><span class="pun">(</span><span class="pln">redis</span><span class="pun">)</span><span class="pln">zset faction</span><span class="pun">:</span><span class="pln">flag</span><span class="pun">:</span><span class="pln">action_info</span><span class="pun">:%</span><span class="pln">u</span><span class="pun">(</span><span class="pln">sid</span><span class="pun">)</span><span class="pln"> </span></code></li><li class="L1"><code><span class="pun">{</span></code></li><li class="L2"><code><span class="pln">    k</span><span class="pun">(</span><span class="pln">uint32 faction_id</span><span class="pun">帮派号),</span></code></li><li class="L3"><code><span class="pln">    score</span><span class="pun">(</span><span class="pln">uint32 timecode_expire</span><span class="pun">),</span></code></li><li class="L4"><code><span class="pun">}</span></code></li><li class="L5"><code><span class="pun">(</span><span class="pln">cache</span><span class="pun">)</span><span class="pln">EXPIRE </span><span class="pun">-</span><span class="lit">1</span></code></li></ol></pre><div class="md-section-divider"></div><h3 data-anchor-id="ryb5" id="开启夺旗">开启夺旗</h3><div class="md-section-divider"></div><div class="sequence-diagram theme theme-white" title="点击查看大图" data-anchor-id="z6mp"><svg height="480" version="1.1" width="773" xmlns="http://www.w3.org/2000/svg" style="overflow: hidden; position: relative;"><desc style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Created with Raphaël 2.1.2</desc><defs style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><path stroke-linecap="round" d="M6,1 1,3.5 6,6" id="raphael-marker-open-obj175" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><marker id="raphael-marker-endopen77-obj176" markerHeight="7" markerWidth="7" orient="auto" refX="4" refY="3.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-open-obj175" transform="rotate(180 3.5 3.5) scale(1,1)" stroke-width="1.0000" fill="none" stroke="#000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker></defs><rect x="10" y="20" width="80" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="20" y="30" width="60" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="50" y="39" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">client</tspan></text><rect x="10" y="422" width="80" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="20" y="432" width="60" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="50" y="441" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">client</tspan></text><path fill="none" stroke="#000000" d="M50,58L50,422" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="150" y="20" width="80" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="160" y="30" width="60" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="190" y="39" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">server</tspan></text><rect x="150" y="422" width="80" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="160" y="432" width="60" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="190" y="441" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">server</tspan></text><path fill="none" stroke="#000000" d="M190,58L190,422" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="473" y="20" width="150" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="483" y="30" width="130" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="548" y="39" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">mq_redis_room</tspan></text><rect x="473" y="422" width="150" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="483" y="432" width="130" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="548" y="441" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">mq_redis_room</tspan></text><path fill="none" stroke="#000000" d="M548,58L548,422" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="643" y="20" width="100" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="653" y="30" width="80" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="693" y="39" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">mq_event</tspan></text><rect x="643" y="422" width="100" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="653" y="432" width="80" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="693" y="441" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">mq_event</tspan></text><path fill="none" stroke="#000000" d="M693,58L693,422" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="60" y="74" width="120" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="120" y="83" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">flag_make_rq</tspan></text><path fill="none" stroke="#000000" d="M50,96C50,96,170.87756633758545,96,187.99401860218495,96" stroke-width="2" marker-end="url(#raphael-marker-endopen77-obj176)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="210" y="116" width="318" height="28" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="215" y="121" width="308" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="369" y="130" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">检测房间内插旗状态(是否已经开启夺旗了)</tspan></text><rect x="210" y="164" width="308" height="28" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="215" y="169" width="298" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="364" y="178" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">没有夺旗状态,将房间夺旗状态置为已开启</tspan></text><rect x="210" y="212" width="228" height="28" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="215" y="217" width="218" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="324" y="226" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">没有夺旗状态,消息和事件通知</tspan></text><rect x="309" y="256" width="120" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="369" y="265" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">flag_make_nt</tspan></text><path fill="none" stroke="#000000" d="M190,278C190,278,517.3936666250229,278,546.008640416956,278" stroke-width="2" marker-end="url(#raphael-marker-endopen77-obj176)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="376.5" y="294" width="130" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="441.5" y="303" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">flag_make_evt</tspan></text><path fill="none" stroke="#000000" d="M190,316C190,316,656.5971741080284,316,690.9996024724387,316" stroke-width="2" marker-end="url(#raphael-marker-endopen77-obj176)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="210" y="336" width="286" height="28" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="215" y="341" width="276" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="353" y="350" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">没有夺旗状态,什么也不干,直接回成功</tspan></text><rect x="60" y="380" width="120" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="120" y="389" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">flag_make_rs</tspan></text><path fill="none" stroke="#000000" d="M190,402C190,402,69.12243366241455,402,52.00598139781505,402" stroke-width="2" marker-end="url(#raphael-marker-endopen77-obj176)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path></svg></div><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="ykwa"><ol class="linenums"><li class="L0"><code><span class="com">// 开启夺旗请求</span></code></li><li class="L1"><code><span class="pln">message flag_make_rq</span></code></li><li class="L2"><code><span class="pun">{</span></code></li><li class="L3"><code><span class="pln">    </span><span class="kwd">enum</span><span class="pln"> msg</span><span class="pun">{</span><span class="pln"> id</span><span class="pun">=</span><span class="lit">0x02140001</span><span class="pun">;}</span></code></li><li class="L4"><code><span class="pln">    required uint64 sid                       </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 房间号</span></code></li><li class="L5"><code><span class="pln">    required uint64 uid                       </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 用户号</span></code></li><li class="L6"><code><span class="pln">    required uint32 faction_id                </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 帮派id</span></code></li><li class="L7"><code><span class="pun">}</span></code></li><li class="L8"><code><span class="com">// 开启夺旗返回</span></code></li><li class="L9"><code><span class="com">// current.faction_id 夺旗状态(-1无 0 开启 &gt;0 帮会id).仅有帮会插旗其他数据才有效</span></code></li><li class="L0"><code><span class="pln">message flag_make_rs</span></code></li><li class="L1"><code><span class="pun">{</span></code></li><li class="L2"><code><span class="pln">    </span><span class="kwd">enum</span><span class="pln"> msg</span><span class="pun">{</span><span class="pln"> id</span><span class="pun">=</span><span class="lit">0x02140002</span><span class="pun">;}</span></code></li><li class="L3"><code><span class="pln">    required b_error</span><span class="pun">.</span><span class="pln">info error               </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">                </span><span class="pun">;</span><span class="pln"> </span><span class="com">// error info</span></code></li><li class="L4"><code><span class="pln">    required uint64 sid                       </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 房间号</span></code></li><li class="L5"><code><span class="pln">    required uint64 uid                       </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 用户号</span></code></li><li class="L6"><code><span class="pln">    required uint32 faction_id                </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 帮派id</span></code></li><li class="L7"><code><span class="pln">    required flag_faction_info current        </span><span class="pun">=</span><span class="pln"> </span><span class="lit">5</span><span class="pln">                </span><span class="pun">;</span><span class="pln"> </span><span class="com">// 当前插旗的帮派数据</span></code></li><li class="L8"><code><span class="pun">}</span></code></li><li class="L9"><code><span class="com">// 开启夺旗通知</span></code></li><li class="L0"><code><span class="pln">message flag_make_nt</span></code></li><li class="L1"><code><span class="pun">{</span></code></li><li class="L2"><code><span class="pln">    </span><span class="kwd">enum</span><span class="pln"> msg</span><span class="pun">{</span><span class="pln"> id</span><span class="pun">=</span><span class="lit">0x02140003</span><span class="pun">;}</span></code></li><li class="L3"><code><span class="pln">    required uint64 sid                       </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 房间号</span></code></li><li class="L4"><code><span class="pln">    required uint64 uid                       </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 用户号</span></code></li><li class="L5"><code><span class="pln">    required uint32 faction_id                </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 帮派id</span></code></li><li class="L6"><code><span class="pln">    required uint32 base_flag_number          </span><span class="pun">=</span><span class="pln"> </span><span class="lit">5</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 帮派夺旗(空旗)基准人数阀值(默认10)</span></code></li><li class="L7"><code><span class="pln">    required flag_faction_info current        </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span><span class="pln">                </span><span class="pun">;</span><span class="pln"> </span><span class="com">// 当前插旗的帮派数据</span></code></li><li class="L8"><code><span class="pun">}</span></code></li></ol></pre><div class="md-section-divider"></div><h3 data-anchor-id="gv3z" id="查询夺旗详情">查询夺旗详情</h3><div class="md-section-divider"></div><div class="sequence-diagram theme theme-white" title="点击查看大图" data-anchor-id="8nub"><svg height="308" version="1.1" width="834" xmlns="http://www.w3.org/2000/svg" style="overflow: hidden; position: relative;"><desc style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Created with Raphaël 2.1.2</desc><defs style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><path stroke-linecap="round" d="M6,1 1,3.5 6,6" id="raphael-marker-open-obj167" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><marker id="raphael-marker-endopen77-obj168" markerHeight="7" markerWidth="7" orient="auto" refX="4" refY="3.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-open-obj167" transform="rotate(180 3.5 3.5) scale(1,1)" stroke-width="1.0000" fill="none" stroke="#000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker></defs><rect x="10" y="20" width="80" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="20" y="30" width="60" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="50" y="39" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">client</tspan></text><rect x="10" y="250" width="80" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="20" y="260" width="60" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="50" y="269" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">client</tspan></text><path fill="none" stroke="#000000" d="M50,58L50,250" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="180" y="20" width="80" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="190" y="30" width="60" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="220" y="39" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">server</tspan></text><rect x="180" y="250" width="80" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="190" y="260" width="60" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="220" y="269" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">server</tspan></text><path fill="none" stroke="#000000" d="M220,58L220,250" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="60" y="74" width="150" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="135" y="83" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">flag_details_rq</tspan></text><path fill="none" stroke="#000000" d="M50,96C50,96,198.94750833511353,96,218.00231653032824,96" stroke-width="2" marker-end="url(#raphael-marker-endopen77-obj168)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="240" y="116" width="334" height="28" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="245" y="121" width="324" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="407" y="130" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">房间内插旗状态(是否已经开启夺旗或抢旗了)</tspan></text><rect x="240" y="164" width="504" height="28" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="245" y="169" width="494" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="492" y="178" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">本帮会基础数据,夺旗人数进度,夺旗过程事件数据,当前旗子帮会数据</tspan></text><rect x="60" y="208" width="150" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="135" y="217" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">flag_details_rs</tspan></text><path fill="none" stroke="#000000" d="M220,230C220,230,71.05249166488647,230,51.997683469671756,230" stroke-width="2" marker-end="url(#raphael-marker-endopen77-obj168)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path></svg></div><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="3q6q"><ol class="linenums"><li class="L0"><code><span class="com">// 夺旗详情请求</span></code></li><li class="L1"><code><span class="pln">message flag_details_rq</span></code></li><li class="L2"><code><span class="pun">{</span></code></li><li class="L3"><code><span class="pln">    </span><span class="kwd">enum</span><span class="pln"> msg</span><span class="pun">{</span><span class="pln"> id</span><span class="pun">=</span><span class="lit">0x02140004</span><span class="pun">;}</span></code></li><li class="L4"><code><span class="pln">    required uint64 sid                       </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 房间号</span></code></li><li class="L5"><code><span class="pln">    required uint64 uid                       </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 用户号</span></code></li><li class="L6"><code><span class="pln">    required uint32 faction_id                </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 帮派id</span></code></li><li class="L7"><code><span class="pun">}</span></code></li><li class="L8"><code><span class="com">// 夺旗详情返回</span></code></li><li class="L9"><code><span class="pln">message flag_details_rs</span></code></li><li class="L0"><code><span class="pun">{</span></code></li><li class="L1"><code><span class="pln">    </span><span class="kwd">enum</span><span class="pln"> msg</span><span class="pun">{</span><span class="pln"> id</span><span class="pun">=</span><span class="lit">0x02140005</span><span class="pun">;}</span></code></li><li class="L2"><code><span class="pln">    required b_error</span><span class="pun">.</span><span class="pln">info error               </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">                </span><span class="pun">;</span><span class="pln"> </span><span class="com">// error info</span></code></li><li class="L3"><code><span class="pln">    required uint64 sid                       </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 房间号</span></code></li><li class="L4"><code><span class="pln">    required uint64 uid                       </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 用户号</span></code></li><li class="L5"><code><span class="pln">    required flag_faction_info current        </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span><span class="pln">                </span><span class="pun">;</span><span class="pln"> </span><span class="com">// 当前插旗的帮派数据</span></code></li><li class="L6"><code><span class="pln">    required flag_faction_info oneself        </span><span class="pun">=</span><span class="pln"> </span><span class="lit">5</span><span class="pln">                </span><span class="pun">;</span><span class="pln"> </span><span class="com">// 自己插旗的帮派数据</span></code></li><li class="L7"><code><span class="pln">    required </span><span class="kwd">string</span><span class="pln"> flag_icon                 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">6</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">""</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 普通旗帜图标</span></code></li><li class="L8"><code><span class="pln">    required uint32 base_flag_number          </span><span class="pun">=</span><span class="pln"> </span><span class="lit">7</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 帮派夺旗(空旗)基准人数阀值(默认10)</span></code></li><li class="L9"><code><span class="pln">    required uint32 timelength                </span><span class="pun">=</span><span class="pln"> </span><span class="lit">8</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 夺旗动作持续时间长度</span></code></li><li class="L0"><code><span class="pln">    required uint32 timecode                  </span><span class="pun">=</span><span class="pln"> </span><span class="lit">9</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 夺旗动作事件触发时间点</span></code></li><li class="L1"><code><span class="pun">}</span></code></li></ol></pre><div class="md-section-divider"></div><h3 data-anchor-id="y6hg" id="成员加入夺旗">成员加入夺旗</h3><div class="md-section-divider"></div><div class="sequence-diagram theme theme-white" title="点击查看大图" data-anchor-id="panf"><svg height="796" version="1.1" width="1047" xmlns="http://www.w3.org/2000/svg" style="overflow: hidden; position: relative;"><desc style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Created with Raphaël 2.1.2</desc><defs style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><path stroke-linecap="round" d="M6,1 1,3.5 6,6" id="raphael-marker-open-obj169" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><marker id="raphael-marker-endopen77-obj170" markerHeight="7" markerWidth="7" orient="auto" refX="4" refY="3.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-open-obj169" transform="rotate(180 3.5 3.5) scale(1,1)" stroke-width="1.0000" fill="none" stroke="#000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker></defs><rect x="10" y="20" width="80" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="20" y="30" width="60" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="50" y="39" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">client</tspan></text><rect x="10" y="738" width="80" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="20" y="748" width="60" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="50" y="757" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">client</tspan></text><path fill="none" stroke="#000000" d="M50,58L50,738" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="150" y="20" width="80" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="160" y="30" width="60" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="190" y="39" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">server</tspan></text><rect x="150" y="738" width="80" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="160" y="748" width="60" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="190" y="757" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">server</tspan></text><path fill="none" stroke="#000000" d="M190,58L190,738" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="747" y="20" width="150" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="757" y="30" width="130" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="822" y="39" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">mq_redis_room</tspan></text><rect x="747" y="738" width="150" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="757" y="748" width="130" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="822" y="757" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">mq_redis_room</tspan></text><path fill="none" stroke="#000000" d="M822,58L822,738" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="917" y="20" width="100" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="927" y="30" width="80" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="967" y="39" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">mq_event</tspan></text><rect x="917" y="738" width="100" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="927" y="748" width="80" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="967" y="757" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">mq_event</tspan></text><path fill="none" stroke="#000000" d="M967,58L967,738" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="60" y="74" width="120" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="120" y="83" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">flag_join_rq</tspan></text><path fill="none" stroke="#000000" d="M50,96C50,96,170.87756633758545,96,187.99401860218495,96" stroke-width="2" marker-end="url(#raphael-marker-endopen77-obj170)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="210" y="116" width="318" height="28" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="215" y="121" width="308" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="369" y="130" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">检测房间内插旗状态(是否已经开启夺旗了)</tspan></text><rect x="210" y="164" width="292" height="28" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="215" y="169" width="282" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="356" y="178" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">在夺旗状态,将房间夺旗状态状态已开启</tspan></text><rect x="210" y="212" width="212" height="28" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="215" y="217" width="202" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="316" y="226" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">在夺旗状态,消息和事件通知</tspan></text><rect x="210" y="260" width="292" height="28" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="215" y="265" width="282" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="356" y="274" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">在抢旗状态,将房间抢旗状态状态在进行</tspan></text><rect x="210" y="308" width="212" height="28" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="215" y="313" width="202" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="316" y="322" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">在抢旗状态,消息和事件通知</tspan></text><rect x="210" y="356" width="122" height="28" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="215" y="361" width="112" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="271" y="370" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">做夺旗加一过程</tspan></text><rect x="215" y="400" width="582" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="506" y="409" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">flag_join_nt(通知房间人数进度变更,不是本帮和当前插旗帮用户忽略本事件)</tspan></text><path fill="none" stroke="#000000" d="M190,422C190,422,781.1756027936935,422,820.0003677232598,422" stroke-width="2" marker-end="url(#raphael-marker-endopen77-obj170)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="513.5" y="438" width="130" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="578.5" y="447" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">flag_join_evt</tspan></text><path fill="none" stroke="#000000" d="M190,460C190,460,921.7713275551796,460,965.0058639976487,460" stroke-width="2" marker-end="url(#raphael-marker-endopen77-obj170)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="200" y="476" width="612" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="506" y="485" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">flag_details_nt(通知房间人数进度变更,不是本帮和当前插旗帮用户忽略本事件)</tspan></text><path fill="none" stroke="#000000" d="M190,498C190,498,781.1756027936935,498,820.0003677232598,498" stroke-width="2" marker-end="url(#raphael-marker-endopen77-obj170)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="210" y="518" width="324" height="28" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="215" y="523" width="314" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="372" y="532" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">人数变更触发了夺旗动作,启动后台夺旗过程</tspan></text><rect x="210" y="566" width="266" height="28" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="215" y="571" width="256" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="343" y="580" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">如果是同一用户，不能重复加入夺旗</tspan></text><rect x="301" y="610" width="410" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="506" y="619" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">flag_action_nt(通知房间夺旗动作开始,各个时间点)</tspan></text><path fill="none" stroke="#000000" d="M190,632C190,632,781.1756027936935,632,820.0003677232598,632" stroke-width="2" marker-end="url(#raphael-marker-endopen77-obj170)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="210" y="652" width="318" height="28" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="215" y="657" width="308" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="369" y="666" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">不是夺旗抢旗状态,什么也不干,直接回失败</tspan></text><rect x="60" y="696" width="120" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="120" y="705" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">flag_join_rs</tspan></text><path fill="none" stroke="#000000" d="M190,718C190,718,69.12243366241455,718,52.00598139781505,718" stroke-width="2" marker-end="url(#raphael-marker-endopen77-obj170)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path></svg></div><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="eg3f"><ol class="linenums"><li class="L0"><code><span class="com">// 成员加入夺旗请求</span></code></li><li class="L1"><code><span class="pln">message flag_join_rq</span></code></li><li class="L2"><code><span class="pun">{</span></code></li><li class="L3"><code><span class="pln">    </span><span class="kwd">enum</span><span class="pln"> msg</span><span class="pun">{</span><span class="pln"> id</span><span class="pun">=</span><span class="lit">0x02140008</span><span class="pun">;}</span></code></li><li class="L4"><code><span class="pln">    required uint64 sid                       </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 房间号</span></code></li><li class="L5"><code><span class="pln">    required uint64 uid                       </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 加入夺旗用户id</span></code></li><li class="L6"><code><span class="pln">    required uint32 faction_id                </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 帮派id</span></code></li><li class="L7"><code><span class="pun">}</span></code></li><li class="L8"><code><span class="com">// 成员加入夺旗返回</span></code></li><li class="L9"><code><span class="pln">message flag_join_rs</span></code></li><li class="L0"><code><span class="pun">{</span></code></li><li class="L1"><code><span class="pln">    </span><span class="kwd">enum</span><span class="pln"> msg</span><span class="pun">{</span><span class="pln"> id</span><span class="pun">=</span><span class="lit">0x02140009</span><span class="pun">;}</span></code></li><li class="L2"><code><span class="pln">    required b_error</span><span class="pun">.</span><span class="pln">info error               </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">                </span><span class="pun">;</span><span class="pln"> </span><span class="com">// error info</span></code></li><li class="L3"><code><span class="pln">    required uint64 sid                       </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 房间号</span></code></li><li class="L4"><code><span class="pln">    required uint64 uid                       </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 加入夺旗用户id</span></code></li><li class="L5"><code><span class="pln">    required flag_faction_info current        </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span><span class="pln">                </span><span class="pun">;</span><span class="pln"> </span><span class="com">// 当前插旗的帮派数据</span></code></li><li class="L6"><code><span class="pln">    required flag_faction_info trigger        </span><span class="pun">=</span><span class="pln"> </span><span class="lit">5</span><span class="pln">                </span><span class="pun">;</span><span class="pln"> </span><span class="com">// 触发插旗的帮派数据</span></code></li><li class="L7"><code><span class="pun">}</span></code></li><li class="L8"><code><span class="com">// 成员加入夺旗通知</span></code></li><li class="L9"><code><span class="pln">message flag_join_nt</span></code></li><li class="L0"><code><span class="pun">{</span></code></li><li class="L1"><code><span class="pln">    </span><span class="kwd">enum</span><span class="pln"> msg</span><span class="pun">{</span><span class="pln"> id</span><span class="pun">=</span><span class="lit">0x0214000A</span><span class="pun">;}</span></code></li><li class="L2"><code><span class="pln">    required uint64 sid                       </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 房间号</span></code></li><li class="L3"><code><span class="pln">    required uint64 uid                       </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 加入夺旗用户id</span></code></li><li class="L4"><code><span class="pln">    required flag_faction_info current        </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pln">                </span><span class="pun">;</span><span class="pln"> </span><span class="com">// 当前插旗的帮派数据</span></code></li><li class="L5"><code><span class="pln">    required flag_faction_info trigger        </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span><span class="pln">                </span><span class="pun">;</span><span class="pln"> </span><span class="com">// 触发插旗的帮派数据</span></code></li><li class="L6"><code><span class="pun">}</span></code></li><li class="L7"><code><span class="com">// 触发夺旗动作通知</span></code></li><li class="L8"><code><span class="pln">message flag_action_nt</span></code></li><li class="L9"><code><span class="pun">{</span></code></li><li class="L0"><code><span class="pln">    </span><span class="kwd">enum</span><span class="pln"> msg</span><span class="pun">{</span><span class="pln"> id</span><span class="pun">=</span><span class="lit">0x0214000B</span><span class="pun">;}</span></code></li><li class="L1"><code><span class="pln">    required uint64 sid                       </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 房间号</span></code></li><li class="L2"><code><span class="pln">    required uint64 uid                       </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 加入夺旗用户id</span></code></li><li class="L3"><code><span class="pln">    required flag_faction_info current        </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pln">                </span><span class="pun">;</span><span class="pln"> </span><span class="com">// 当前插旗的帮派数据</span></code></li><li class="L4"><code><span class="pln">    required flag_faction_info trigger        </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span><span class="pln">                </span><span class="pun">;</span><span class="pln"> </span><span class="com">// 触发插旗的帮派数据</span></code></li><li class="L5"><code><span class="pln">    required uint32 timelength                </span><span class="pun">=</span><span class="pln"> </span><span class="lit">5</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 夺旗动作持续时间长度</span></code></li><li class="L6"><code><span class="pln">    required uint32 timecode                  </span><span class="pun">=</span><span class="pln"> </span><span class="lit">6</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 夺旗动作事件触发时间点</span></code></li><li class="L7"><code><span class="pun">}</span></code></li><li class="L8"><code><span class="com">// 夺旗结算通知</span></code></li><li class="L9"><code><span class="com">// 夺旗动作结算时由服务端主动发起</span></code></li><li class="L0"><code><span class="com">// 这个包会在直播间发送,用户抛掉没有自己帮派faction_id的数据</span></code></li><li class="L1"><code><span class="pln">message flag_settlement_nt</span></code></li><li class="L2"><code><span class="pun">{</span></code></li><li class="L3"><code><span class="pln">    </span><span class="kwd">enum</span><span class="pln"> msg</span><span class="pun">{</span><span class="pln"> id</span><span class="pun">=</span><span class="lit">0x0214000C</span><span class="pun">;}</span></code></li><li class="L4"><code><span class="pln">    </span><span class="kwd">enum</span><span class="pln"> </span><span class="typ">opcode_t</span></code></li><li class="L5"><code><span class="pln">    </span><span class="pun">{</span><span class="pln"> </span></code></li><li class="L6"><code><span class="pln">        op_status_clean </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="com">// 清除旗位</span></code></li><li class="L7"><code><span class="pln">        op_wins_success </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="com">// 夺旗成功</span></code></li><li class="L8"><code><span class="pln">        op_wins_failure </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="com">// 夺旗失败</span></code></li><li class="L9"><code><span class="pln">    </span><span class="pun">}</span></code></li><li class="L0"><code><span class="pln">    required uint64 sid                       </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 房间号</span></code></li><li class="L1"><code><span class="pln">    required flag_faction_info current        </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln">                </span><span class="pun">;</span><span class="pln"> </span><span class="com">// 当前插旗的帮派数据</span></code></li><li class="L2"><code><span class="pln">    required flag_faction_info thelast        </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pln">                </span><span class="pun">;</span><span class="pln"> </span><span class="com">// 上次插旗的帮派数据</span></code></li><li class="L3"><code><span class="pln">    repeated flag_faction_info failure        </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span><span class="pln">                </span><span class="pun">;</span><span class="pln"> </span><span class="com">// 失败插旗的帮派数据</span></code></li><li class="L4"><code><span class="pln">    required </span><span class="kwd">string</span><span class="pln"> flag_icon                 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">5</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">""</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 普通旗帜图标</span></code></li><li class="L5"><code><span class="pln">    required uint32 opcode                    </span><span class="pun">=</span><span class="pln"> </span><span class="lit">6</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 操作码</span></code></li><li class="L6"><code><span class="pln">    required uint32 timelength                </span><span class="pun">=</span><span class="pln"> </span><span class="lit">7</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 夺旗动作持续时间长度</span></code></li><li class="L7"><code><span class="pln">    required uint32 timecode                  </span><span class="pun">=</span><span class="pln"> </span><span class="lit">8</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 夺旗动作事件触发时间点</span></code></li><li class="L8"><code><span class="pun">}</span></code></li></ol></pre><div class="md-section-divider"></div><h3 data-anchor-id="458s" id="成员退出夺旗">成员退出夺旗</h3><div class="md-section-divider"></div><div class="sequence-diagram theme theme-white" title="点击查看大图" data-anchor-id="h9zm"><svg height="480" version="1.1" width="875" xmlns="http://www.w3.org/2000/svg" style="overflow: hidden; position: relative;"><desc style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Created with Raphaël 2.1.2</desc><defs style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><path stroke-linecap="round" d="M6,1 1,3.5 6,6" id="raphael-marker-open-obj171" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><marker id="raphael-marker-endopen77-obj172" markerHeight="7" markerWidth="7" orient="auto" refX="4" refY="3.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-open-obj171" transform="rotate(180 3.5 3.5) scale(1,1)" stroke-width="1.0000" fill="none" stroke="#000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker></defs><rect x="10" y="20" width="80" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="20" y="30" width="60" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="50" y="39" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">client</tspan></text><rect x="10" y="422" width="80" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="20" y="432" width="60" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="50" y="441" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">client</tspan></text><path fill="none" stroke="#000000" d="M50,58L50,422" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="150" y="20" width="80" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="160" y="30" width="60" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="190" y="39" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">server</tspan></text><rect x="150" y="422" width="80" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="160" y="432" width="60" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="190" y="441" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">server</tspan></text><path fill="none" stroke="#000000" d="M190,58L190,422" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="575" y="20" width="150" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="585" y="30" width="130" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="650" y="39" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">mq_redis_room</tspan></text><rect x="575" y="422" width="150" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="585" y="432" width="130" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="650" y="441" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">mq_redis_room</tspan></text><path fill="none" stroke="#000000" d="M650,58L650,422" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="745" y="20" width="100" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="755" y="30" width="80" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="795" y="39" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">mq_event</tspan></text><rect x="745" y="422" width="100" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="755" y="432" width="80" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="795" y="441" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">mq_event</tspan></text><path fill="none" stroke="#000000" d="M795,58L795,422" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="60" y="74" width="120" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="120" y="83" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">flag_exit_rq</tspan></text><path fill="none" stroke="#000000" d="M50,96C50,96,170.87756633758545,96,187.99401860218495,96" stroke-width="2" marker-end="url(#raphael-marker-endopen77-obj172)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="210" y="116" width="270" height="28" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="215" y="121" width="260" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="345" y="130" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">检测房间内插旗状态(是否夺旗成功)</tspan></text><rect x="360" y="160" width="120" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="420" y="169" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">flag_exit_nt</tspan></text><path fill="none" stroke="#000000" d="M190,182C190,182,615.1961851119995,182,647.999406424351,182" stroke-width="2" marker-end="url(#raphael-marker-endopen77-obj172)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="427.5" y="198" width="130" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="492.5" y="207" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">flag_exit_evt</tspan></text><path fill="none" stroke="#000000" d="M190,220C190,220,755.0628782063723,220,793.000449375013,220" stroke-width="2" marker-end="url(#raphael-marker-endopen77-obj172)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="210" y="240" width="218" height="28" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="215" y="245" width="208" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="319" y="254" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">正在夺旗状态，夺旗人数减一</tspan></text><rect x="210" y="288" width="378" height="28" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="215" y="293" width="368" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="399" y="302" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">已经夺旗状态，夺旗人数减一，如果临界，夺旗失败</tspan></text><rect x="210" y="336" width="420" height="28" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="215" y="341" width="410" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="420" y="350" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">flag_action_nt(通知房间夺旗动作开始,各个时间点)</tspan></text><rect x="60" y="380" width="120" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="120" y="389" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">flag_exit_rq</tspan></text><path fill="none" stroke="#000000" d="M190,402C190,402,69.12243366241455,402,52.00598139781505,402" stroke-width="2" marker-end="url(#raphael-marker-endopen77-obj172)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path></svg></div><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="o8ty"><ol class="linenums"><li class="L0"><code><span class="com">// 成员退出夺旗请求</span></code></li><li class="L1"><code><span class="pln">message flag_exit_rq</span></code></li><li class="L2"><code><span class="pun">{</span></code></li><li class="L3"><code><span class="pln">    </span><span class="kwd">enum</span><span class="pln"> msg</span><span class="pun">{</span><span class="pln"> id</span><span class="pun">=</span><span class="lit">0x0214000D</span><span class="pun">;}</span></code></li><li class="L4"><code><span class="pln">    required uint64 sid                       </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 房间号</span></code></li><li class="L5"><code><span class="pln">    required uint64 uid                       </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 退出夺旗用户id</span></code></li><li class="L6"><code><span class="pln">    required uint32 faction_id                </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 帮派id</span></code></li><li class="L7"><code><span class="pun">}</span></code></li><li class="L8"><code><span class="com">// 成员退出夺旗返回</span></code></li><li class="L9"><code><span class="pln">message flag_exit_rs</span></code></li><li class="L0"><code><span class="pun">{</span></code></li><li class="L1"><code><span class="pln">    </span><span class="kwd">enum</span><span class="pln"> msg</span><span class="pun">{</span><span class="pln"> id</span><span class="pun">=</span><span class="lit">0x0214000E</span><span class="pun">;}</span></code></li><li class="L2"><code><span class="pln">    required b_error</span><span class="pun">.</span><span class="pln">info error               </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">                </span><span class="pun">;</span><span class="pln"> </span><span class="com">// error info</span></code></li><li class="L3"><code><span class="pln">    required uint64 sid                       </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 房间号</span></code></li><li class="L4"><code><span class="pln">    required uint64 uid                       </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 退出夺旗用户id</span></code></li><li class="L5"><code><span class="pln">    required flag_faction_info current        </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span><span class="pln">                </span><span class="pun">;</span><span class="pln"> </span><span class="com">// 当前插旗的帮派数据</span></code></li><li class="L6"><code><span class="pln">    required flag_faction_info trigger        </span><span class="pun">=</span><span class="pln"> </span><span class="lit">5</span><span class="pln">                </span><span class="pun">;</span><span class="pln"> </span><span class="com">// 触发插旗的帮派数据</span></code></li><li class="L7"><code><span class="pun">}</span></code></li><li class="L8"><code><span class="com">// 成员退出夺旗通知</span></code></li><li class="L9"><code><span class="pln">message flag_exit_nt</span></code></li><li class="L0"><code><span class="pun">{</span></code></li><li class="L1"><code><span class="pln">    </span><span class="kwd">enum</span><span class="pln"> msg</span><span class="pun">{</span><span class="pln"> id</span><span class="pun">=</span><span class="lit">0x0214000F</span><span class="pun">;}</span></code></li><li class="L2"><code><span class="pln">    required uint64 sid                       </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 房间号</span></code></li><li class="L3"><code><span class="pln">    required uint64 uid                       </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="lit">0</span><span class="pln"> </span><span class="pun">];</span><span class="pln"> </span><span class="com">// 退出夺旗用户id</span></code></li><li class="L4"><code><span class="pln">    required flag_faction_info current        </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pln">                </span><span class="pun">;</span><span class="pln"> </span><span class="com">// 当前插旗的帮派数据</span></code></li><li class="L5"><code><span class="pln">    required flag_faction_info trigger        </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span><span class="pln">                </span><span class="pun">;</span><span class="pln"> </span><span class="com">// 触发插旗的帮派数据</span></code></li><li class="L6"><code><span class="pun">}</span></code></li></ol></pre><div class="md-section-divider"></div><h3 data-anchor-id="qyt7" id="用户进入直播间事件">用户进入直播间事件</h3><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="i4bo"><ol class="linenums"><li class="L0"><code><span class="pun">发</span><span class="pln">flag_details_rq</span><span class="pun">查询夺旗详情</span></code></li></ol></pre><div class="md-section-divider"></div><h3 data-anchor-id="hnea" id="用户离开直播间事件">用户离开直播间事件</h3><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="d7gl"><ol class="linenums"><li class="L0"><code><span class="pun">用户未参与夺旗，直接退出</span></code></li><li class="L1"><code><span class="pun">参与夺旗过程，发</span><span class="pln">flag_exit_rq</span><span class="pun">成员退出夺旗</span></code></li></ol></pre><div class="md-section-divider"></div><h3 data-anchor-id="0ptm" id="主播离开直播间事件">主播离开直播间事件</h3><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="7i2f"><ol class="linenums"><li class="L0"><code><span class="pun">移除所有帮会插旗成员数据</span></code></li><li class="L1"><code><span class="pun">将本房间的夺旗状态置为未-</span><span class="lit">1</span><span class="pun">(开启夺旗)</span></code></li><li class="L2"><code><span class="pun">将本房间的夺旗动作状态清除</span></code></li></ol></pre><div class="md-section-divider"></div><h3 data-anchor-id="eo7h" id="主播心跳事件">主播心跳事件</h3><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="io3u"><ol class="linenums"><li class="L0"><code><span class="pun">夺旗动作结算由主播心跳触发</span></code></li><li class="L1"><code><span class="com">// 结算逻辑无论是插旗还是夺旗结算逻辑都为:对本房间的每次结算都依次进行一下逻辑</span></code></li><li class="L2"><code><span class="com">// 1.对本次结算帮派做结算查看分数最大的帮派是否是自己,不是自己则夺旗失败,是自己则夺旗成功</span></code></li><li class="L3"><code><span class="com">// 2.当前插旗的帮派做结算查看分数最大的帮派是否是自己,不是自己则守旗失败,是自己则守旗成功</span></code></li><li class="L4"><code><span class="com">// 3.结算当前优胜帮派分数需要保证大于基准分数,否则将本房间置为空旗状态</span></code></li><li class="L5"><code><span class="com">// 结算 对于并列第一的情况,先结算的帮派算夺旗成功.</span></code></li><li class="L6"><code><span class="com">// 结算 对于并列第一的情况,算守旗成功.</span></code></li><li class="L7"><code><span class="pun">发</span><span class="pln"> flag_details_nt </span><span class="pun">夺旗详情</span></code></li></ol></pre><div class="md-section-divider"></div><div class="sequence-diagram theme theme-white" title="点击查看大图" data-anchor-id="h5d9"><svg height="404" version="1.1" width="677" xmlns="http://www.w3.org/2000/svg" style="overflow: hidden; position: relative;"><desc style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Created with Raphaël 2.1.2</desc><defs style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><path stroke-linecap="round" d="M6,1 1,3.5 6,6" id="raphael-marker-open-obj173" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><marker id="raphael-marker-endopen77-obj174" markerHeight="7" markerWidth="7" orient="auto" refX="4" refY="3.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-open-obj173" transform="rotate(180 3.5 3.5) scale(1,1)" stroke-width="1.0000" fill="none" stroke="#000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker></defs><rect x="10" y="20" width="40" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="20" y="30" width="20" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="30" y="39" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">mq</tspan></text><rect x="10" y="346" width="40" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="20" y="356" width="20" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="30" y="365" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">mq</tspan></text><path fill="none" stroke="#000000" d="M30,58L30,346" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="210" y="20" width="80" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="220" y="30" width="60" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="250" y="39" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">server</tspan></text><rect x="210" y="346" width="80" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="220" y="356" width="60" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="250" y="365" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">server</tspan></text><path fill="none" stroke="#000000" d="M250,58L250,346" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="497" y="20" width="150" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="507" y="30" width="130" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="572" y="39" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">redis_room_mq</tspan></text><rect x="497" y="346" width="150" height="38" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="507" y="356" width="130" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="572" y="365" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">redis_room_mq</tspan></text><path fill="none" stroke="#000000" d="M572,58L572,346" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="40" y="74" width="200" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="140" y="83" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">event_room_heartbeat</tspan></text><path fill="none" stroke="#000000" d="M30,96C30,96,225.986647605896,96,247.99686681944877,96" stroke-width="2" marker-end="url(#raphael-marker-endopen77-obj174)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="270" y="116" width="282" height="28" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="275" y="121" width="272" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="411" y="130" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">检测房间夺旗动作时间点是否已经超时</tspan></text><rect x="270" y="164" width="218" height="28" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="275" y="169" width="208" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="379" y="178" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">将本房间的夺旗动作状态清除</tspan></text><rect x="270" y="212" width="234" height="28" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="275" y="217" width="224" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="387" y="226" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">获取分数最大的帮派和所有帮派</tspan></text><rect x="270" y="260" width="90" height="28" r="0" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="275" y="265" width="80" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="315" y="274" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">做夺旗结算</tspan></text><rect x="336" y="304" width="150" height="18" r="0" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="411" y="313" text-anchor="middle" font="10px &quot;Arial&quot;" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 16px; line-height: normal; font-family: 'Andale Mono', monospace;" font-size="16px" font-family="Andale Mono, monospace"><tspan dy="5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">flag_details_nt</tspan></text><path fill="none" stroke="#000000" d="M250,326C250,326,542.969761967659,326,570.0065222273697,326" stroke-width="2" marker-end="url(#raphael-marker-endopen77-obj174)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path></svg></div><p data-anchor-id="sx31">夺旗动作触发</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="szxa"><ol class="linenums"><li class="L0"><code><span class="com">// 当前房间无帮派且触发帮派人数大于等于基准数量                                               (插旗)</span></code></li><li class="L1"><code><span class="com">// 当前帮派和触发帮派不同且触发帮派人数大于当前帮派                                           (夺旗)</span></code></li><li class="L2"><code><span class="com">// 触发帮派为当前帮派且为人数减少事件且当前帮派人数小于基准帮派                               (清旗)</span></code></li><li class="L3"><code><span class="com">// 当触发帮派为当前帮派,动作为减少,当时最多人数的帮派不是当前帮派,人数小于当时最多人数的帮派  (夺旗)</span></code></li></ol></pre></div>
</body>
</html>